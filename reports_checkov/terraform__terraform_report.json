{
    "check_type": "terraform",
    "results": {
        "failed_checks": [
            {
                "check_id": "CKV_AZURE_137",
                "bc_check_id": "BC_AZR_IAM_4",
                "check_name": "Ensure ACR admin account is disabled",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "admin_enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACRAdminAccountDisabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/bc-azure-137",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_163",
                "bc_check_id": "BC_AZR_GENERAL_93",
                "check_name": "Enable vulnerability scanning for container images.",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "sku"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACRContainerScanEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-163",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_165",
                "bc_check_id": "BC_AZR_NETWORKING_65",
                "check_name": "Ensure geo-replicated container registries to match multi-region container deployments.",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "sku",
                        "georeplications"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACRGeoreplicated",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-165",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_139",
                "bc_check_id": "BC_AZR_NETWORKING_54",
                "check_name": "Ensure ACR set to disable public networking",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "public_network_access_enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACRPublicNetworkAccessDisabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-azure-acr-is-set-to-disable-public-networking",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_237",
                "bc_check_id": "BC_AZR_GENERAL_141",
                "check_name": "Ensure dedicated data endpoints are enabled.",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "data_endpoint_enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACRDedicatedDataEndpointEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-237",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_164",
                "bc_check_id": "BC_AZR_GENERAL_94",
                "check_name": "Ensures that ACR uses signed/trusted images",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "trust_policy_enabled",
                        "trust_policy/enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACRUseSignedImages",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-164",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_167",
                "bc_check_id": "BC_AZR_GENERAL_96",
                "check_name": "Ensure a retention policy is set to cleanup untagged manifests.",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "retention_policy_in_days",
                        "retention_policy/enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACREnableRetentionPolicy",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-167",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_233",
                "bc_check_id": "BC_AZR_STORAGE_10",
                "check_name": "Ensure Azure Container Registry (ACR) is zone redundant",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "zone_redundancy_enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACREnableZoneRedundancy",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/bc-azure-233",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_166",
                "bc_check_id": "BC_AZR_GENERAL_95",
                "check_name": "Ensure container image quarantine, scan, and mark images verified",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "quarantine_policy_enabled"
                    ]
                },
                "code_block": [
                    [
                        2,
                        "resource \"azurerm_container_registry\" \"acr\" {\n"
                    ],
                    [
                        3,
                        "  name                = \"${var.acr_name_prefix}${random_integer.suffix.result}\"\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  sku                 = \"Basic\"\n"
                    ],
                    [
                        7,
                        "  admin_enabled       = true\n"
                    ],
                    [
                        8,
                        "\n"
                    ],
                    [
                        9,
                        "  identity {\n"
                    ],
                    [
                        10,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "}\n"
                    ]
                ],
                "file_path": "/acr.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "repo_file_path": "/terraform/acr.tf",
                "file_line_range": [
                    2,
                    12
                ],
                "resource": "azurerm_container_registry.acr",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.ACREnableImageQuarantine",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-166",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                "breadcrumbs": {
                    "name": [
                        {
                            "type": "resource",
                            "name": "random_integer.suffix",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/acr.tf",
                            "module_connection": false
                        }
                    ],
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_141",
                "bc_check_id": "BC_AZR_IAM_3",
                "check_name": "Ensure AKS local admin account is disabled",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "local_account_disabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSLocalAdminDisabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-iam-policies/ensure-azure-kubernetes-service-aks-local-admin-account-is-disabled",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_116",
                "bc_check_id": "BC_AZR_KUBERNETES_7",
                "check_name": "Ensure that AKS uses Azure Policies Add-on",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "addon_profile/[0]/azure_policy/[0]/enabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSUsesAzurePoliciesAddon",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-azure-policies-add-on",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_168",
                "bc_check_id": "BC_AZR_KUBERNETES_15",
                "check_name": "Ensure Azure Kubernetes Cluster (AKS) nodes should use a minimum number of 50 pods.",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "default_node_pool/max_pods"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSMaxPodsMinimum",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/azr-kubernetes-168",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_117",
                "bc_check_id": "BC_AZR_KUBERNETES_8",
                "check_name": "Ensure that AKS uses disk encryption set",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "disk_encryption_set_id"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSUsesDiskEncryptionSet",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-uses-disk-encryption-set",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_7",
                "bc_check_id": "BC_AZR_KUBERNETES_4",
                "check_name": "Ensure AKS cluster has Network Policy configured",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "network_profile/[0]/network_policy"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSNetworkPolicy",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-4",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_226",
                "bc_check_id": "BC_AZR_KUBERNETES_17",
                "check_name": "Ensure ephemeral disks are used for OS disks",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "default_node_pool/[0]/os_disk_type"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSEphemeralOSDisks",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-226",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_170",
                "bc_check_id": "BC_AZR_GENERAL_97",
                "check_name": "Ensure that AKS use the Paid Sku for its SLA",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "sku_tier"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSIsPaidSku",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-170",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_115",
                "bc_check_id": "BC_AZR_KUBERNETES_6",
                "check_name": "Ensure that AKS enables private clusters",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "private_cluster_enabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSEnablesPrivateClusters",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/ensure-that-aks-enables-private-clusters",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_227",
                "bc_check_id": "BC_AZR_KUBERNETES_18",
                "check_name": "Ensure that the AKS cluster encrypt temp disks, caches, and data flows between Compute and Storage resources",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "default_node_pool/[0]/enable_host_encryption",
                        "default_node_pool/[0]/host_encryption_enabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSEncryptionAtHostEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-227",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_172",
                "bc_check_id": "BC_AZR_GENERAL_98",
                "check_name": "Ensure autorotation of Secrets Store CSI Driver secrets for AKS clusters",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "key_vault_secrets_provider/secret_rotation_enabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSSecretStoreRotation",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/azr-general-172",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_171",
                "bc_check_id": "BC_AZR_NETWORKING_66",
                "check_name": "Ensure AKS cluster upgrade channel is chosen",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "automatic_upgrade_channel",
                        "automatic_channel_upgrade"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSUpgradeChannel",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-171",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_4",
                "bc_check_id": "BC_AZR_KUBERNETES_1",
                "check_name": "Ensure AKS logging to Azure Monitoring is Configured",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "addon_profile/[0]/oms_agent/[0]/enabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSLoggingEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-1",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_6",
                "bc_check_id": "BC_AZR_KUBERNETES_3",
                "check_name": "Ensure AKS has an API Server Authorized IP Ranges enabled",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "api_server_access_profile/[0]/authorized_ip_ranges/[0]"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSApiServerAuthorizedIpRanges",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azr-kubernetes-3",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_232",
                "bc_check_id": "BC_AZR_KUBERNETES_19",
                "check_name": "Ensure that only critical system pods run on system nodes",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "default_node_pool/[0]/only_critical_addons_enabled"
                    ]
                },
                "code_block": [
                    [
                        1,
                        "resource \"azurerm_kubernetes_cluster\" \"aks\" {\n"
                    ],
                    [
                        2,
                        "  name                = \"aks-n8n-cluster\"\n"
                    ],
                    [
                        3,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        4,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        5,
                        "  dns_prefix          = \"n8n-aks\"\n"
                    ],
                    [
                        6,
                        "\n"
                    ],
                    [
                        7,
                        "  network_profile {\n"
                    ],
                    [
                        8,
                        "    network_plugin = \"azure\"\n"
                    ],
                    [
                        9,
                        "    service_cidr   = \"10.10.0.0/16\"\n"
                    ],
                    [
                        10,
                        "    dns_service_ip = \"10.10.0.10\"\n"
                    ],
                    [
                        11,
                        "  }\n"
                    ],
                    [
                        12,
                        "\n"
                    ],
                    [
                        13,
                        "  default_node_pool {\n"
                    ],
                    [
                        14,
                        "    name           = \"default\"\n"
                    ],
                    [
                        15,
                        "    node_count     = 3\n"
                    ],
                    [
                        16,
                        "    vm_size        = \"Standard_D2_v3\"\n"
                    ],
                    [
                        17,
                        "    vnet_subnet_id = azurerm_subnet.Subnet1.id\n"
                    ],
                    [
                        18,
                        "\n"
                    ],
                    [
                        19,
                        "    temporary_name_for_rotation = \"tempnode\"\n"
                    ],
                    [
                        20,
                        "  }\n"
                    ],
                    [
                        21,
                        "\n"
                    ],
                    [
                        22,
                        "  identity {\n"
                    ],
                    [
                        23,
                        "    type = \"SystemAssigned\"\n"
                    ],
                    [
                        24,
                        "  }\n"
                    ],
                    [
                        25,
                        "\n"
                    ],
                    [
                        26,
                        "  role_based_access_control_enabled = true\n"
                    ],
                    [
                        27,
                        "}"
                    ]
                ],
                "file_path": "/aks.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "repo_file_path": "/terraform/aks.tf",
                "file_line_range": [
                    1,
                    27
                ],
                "resource": "azurerm_kubernetes_cluster.aks",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.AKSOnlyCriticalPodsOnSystemNodes",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-kubernetes-policies/bc-azure-232",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/aks.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_136",
                "bc_check_id": "BC_AZR_GENERAL_87",
                "check_name": "Ensure that PostgreSQL Flexible server enables geo-redundant backups",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "geo_redundant_backup_enabled"
                    ]
                },
                "code_block": [
                    [
                        14,
                        "resource \"azurerm_postgresql_flexible_server\" \"pg\" {\n"
                    ],
                    [
                        15,
                        "  name                   = \"pg-n8n-tf-server\"\n"
                    ],
                    [
                        16,
                        "  resource_group_name    = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        17,
                        "  location               = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        18,
                        "  zone                   = \"1\"\n"
                    ],
                    [
                        19,
                        "  version                = \"14\"\n"
                    ],
                    [
                        20,
                        "  administrator_login    = \"n8nadmin\"\n"
                    ],
                    [
                        21,
                        "  administrator_password = azurerm_key_vault_secret.pg_password.value\n"
                    ],
                    [
                        22,
                        "  storage_mb             = 32768\n"
                    ],
                    [
                        23,
                        "  sku_name               = \"B_Standard_B2s\"\n"
                    ],
                    [
                        24,
                        "\n"
                    ],
                    [
                        25,
                        "  delegated_subnet_id           = azurerm_subnet.Subnet2.id\n"
                    ],
                    [
                        26,
                        "  public_network_access_enabled = false\n"
                    ],
                    [
                        27,
                        "  private_dns_zone_id           = azurerm_private_dns_zone.pg_private_dns.id\n"
                    ],
                    [
                        28,
                        "}\n"
                    ]
                ],
                "file_path": "/databases.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "repo_file_path": "/terraform/databases.tf",
                "file_line_range": [
                    14,
                    28
                ],
                "resource": "azurerm_postgresql_flexible_server.pg",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.PostgreSQLFlexiServerGeoBackupEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-azure-postgresql-flexible-server-enables-geo-redundant-backups",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ],
                    "administrator_password": [
                        {
                            "type": "resource",
                            "name": "azurerm_key_vault_secret.pg_password",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_148",
                "bc_check_id": "BC_AZR_NETWORKING_59",
                "check_name": "Ensure Redis Cache is using the latest version of TLS encryption",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "minimum_tls_version"
                    ]
                },
                "code_block": [
                    [
                        37,
                        "resource \"azurerm_redis_cache\" \"redis\" {\n"
                    ],
                    [
                        38,
                        "  name                = \"redis-n8n-tf-cache\"\n"
                    ],
                    [
                        39,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        40,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        41,
                        "  capacity            = 1\n"
                    ],
                    [
                        42,
                        "  family              = \"C\"\n"
                    ],
                    [
                        43,
                        "  sku_name            = \"Basic\"\n"
                    ],
                    [
                        44,
                        "}"
                    ]
                ],
                "file_path": "/databases.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "repo_file_path": "/terraform/databases.tf",
                "file_line_range": [
                    37,
                    44
                ],
                "resource": "azurerm_redis_cache.redis",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.RedisCacheMinTLSVersion",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-azure-aks-cluster-nodes-do-not-have-public-ip-addresses",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_89",
                "bc_check_id": "BC_AZR_NETWORKING_23",
                "check_name": "Ensure that Azure Cache for Redis disables public network access",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "public_network_access_enabled"
                    ]
                },
                "code_block": [
                    [
                        37,
                        "resource \"azurerm_redis_cache\" \"redis\" {\n"
                    ],
                    [
                        38,
                        "  name                = \"redis-n8n-tf-cache\"\n"
                    ],
                    [
                        39,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        40,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        41,
                        "  capacity            = 1\n"
                    ],
                    [
                        42,
                        "  family              = \"C\"\n"
                    ],
                    [
                        43,
                        "  sku_name            = \"Basic\"\n"
                    ],
                    [
                        44,
                        "}"
                    ]
                ],
                "file_path": "/databases.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "repo_file_path": "/terraform/databases.tf",
                "file_line_range": [
                    37,
                    44
                ],
                "resource": "azurerm_redis_cache.redis",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.RedisCachePublicNetworkAccessEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-azure-cache-for-redis-disables-public-network-access",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_230",
                "bc_check_id": "BC_AZR_STORAGE_8",
                "check_name": "Standard Replication should be enabled",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "sku_name"
                    ]
                },
                "code_block": [
                    [
                        37,
                        "resource \"azurerm_redis_cache\" \"redis\" {\n"
                    ],
                    [
                        38,
                        "  name                = \"redis-n8n-tf-cache\"\n"
                    ],
                    [
                        39,
                        "  location            = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        40,
                        "  resource_group_name = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        41,
                        "  capacity            = 1\n"
                    ],
                    [
                        42,
                        "  family              = \"C\"\n"
                    ],
                    [
                        43,
                        "  sku_name            = \"Basic\"\n"
                    ],
                    [
                        44,
                        "}"
                    ]
                ],
                "file_path": "/databases.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "repo_file_path": "/terraform/databases.tf",
                "file_line_range": [
                    37,
                    44
                ],
                "resource": "azurerm_redis_cache.redis",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.RedisCacheStandardReplicationEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-storage-policies/bc-azure-230",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/databases.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_42",
                "bc_check_id": "BC_AZR_GENERAL_11",
                "check_name": "Ensure the key vault is recoverable",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "purge_protection_enabled",
                        "soft_delete_enabled"
                    ]
                },
                "code_block": [
                    [
                        3,
                        "resource \"azurerm_key_vault\" \"akv\" {\n"
                    ],
                    [
                        4,
                        "  name                       = \"akv-n8n-tf-secrets\"\n"
                    ],
                    [
                        5,
                        "  location                   = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  resource_group_name        = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        7,
                        "  tenant_id                  = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        8,
                        "  sku_name                   = \"standard\"\n"
                    ],
                    [
                        9,
                        "  soft_delete_retention_days = 7\n"
                    ],
                    [
                        10,
                        "\n"
                    ],
                    [
                        11,
                        "  access_policy {\n"
                    ],
                    [
                        12,
                        "    tenant_id = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        13,
                        "    object_id = data.azurerm_client_config.current.object_id\n"
                    ],
                    [
                        14,
                        "\n"
                    ],
                    [
                        15,
                        "    secret_permissions = [\n"
                    ],
                    [
                        16,
                        "      \"Get\",\n"
                    ],
                    [
                        17,
                        "      \"List\",\n"
                    ],
                    [
                        18,
                        "      \"Set\",\n"
                    ],
                    [
                        19,
                        "      \"Delete\"\n"
                    ],
                    [
                        20,
                        "]\n"
                    ],
                    [
                        21,
                        "  }\n"
                    ],
                    [
                        22,
                        "  lifecycle {\n"
                    ],
                    [
                        23,
                        "    # \ud83d\udca5 SOLUTION : Ignorer tous les changements APRES la cr\u00e9ation\n"
                    ],
                    [
                        24,
                        "    # Si d'autres politiques sont ajout\u00e9es manuellement ou par d'autres scripts,\n"
                    ],
                    [
                        25,
                        "    # Terraform ignorera les changements sur la liste compl\u00e8te des politiques.\n"
                    ],
                    [
                        26,
                        "    ignore_changes = [\n"
                    ],
                    [
                        27,
                        "      access_policy\n"
                    ],
                    [
                        28,
                        "    ]\n"
                    ],
                    [
                        29,
                        "  }\n"
                    ],
                    [
                        30,
                        "}\n"
                    ]
                ],
                "file_path": "/keyvault.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "repo_file_path": "/terraform/keyvault.tf",
                "file_line_range": [
                    3,
                    30
                ],
                "resource": "azurerm_key_vault.akv",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.KeyvaultRecoveryEnabled",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-the-key-vault-is-recoverable",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_109",
                "bc_check_id": "BC_AZR_NETWORKING_33",
                "check_name": "Ensure that key vault allows firewall rules settings",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "network_acls/[0]/default_action"
                    ]
                },
                "code_block": [
                    [
                        3,
                        "resource \"azurerm_key_vault\" \"akv\" {\n"
                    ],
                    [
                        4,
                        "  name                       = \"akv-n8n-tf-secrets\"\n"
                    ],
                    [
                        5,
                        "  location                   = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  resource_group_name        = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        7,
                        "  tenant_id                  = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        8,
                        "  sku_name                   = \"standard\"\n"
                    ],
                    [
                        9,
                        "  soft_delete_retention_days = 7\n"
                    ],
                    [
                        10,
                        "\n"
                    ],
                    [
                        11,
                        "  access_policy {\n"
                    ],
                    [
                        12,
                        "    tenant_id = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        13,
                        "    object_id = data.azurerm_client_config.current.object_id\n"
                    ],
                    [
                        14,
                        "\n"
                    ],
                    [
                        15,
                        "    secret_permissions = [\n"
                    ],
                    [
                        16,
                        "      \"Get\",\n"
                    ],
                    [
                        17,
                        "      \"List\",\n"
                    ],
                    [
                        18,
                        "      \"Set\",\n"
                    ],
                    [
                        19,
                        "      \"Delete\"\n"
                    ],
                    [
                        20,
                        "]\n"
                    ],
                    [
                        21,
                        "  }\n"
                    ],
                    [
                        22,
                        "  lifecycle {\n"
                    ],
                    [
                        23,
                        "    # \ud83d\udca5 SOLUTION : Ignorer tous les changements APRES la cr\u00e9ation\n"
                    ],
                    [
                        24,
                        "    # Si d'autres politiques sont ajout\u00e9es manuellement ou par d'autres scripts,\n"
                    ],
                    [
                        25,
                        "    # Terraform ignorera les changements sur la liste compl\u00e8te des politiques.\n"
                    ],
                    [
                        26,
                        "    ignore_changes = [\n"
                    ],
                    [
                        27,
                        "      access_policy\n"
                    ],
                    [
                        28,
                        "    ]\n"
                    ],
                    [
                        29,
                        "  }\n"
                    ],
                    [
                        30,
                        "}\n"
                    ]
                ],
                "file_path": "/keyvault.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "repo_file_path": "/terraform/keyvault.tf",
                "file_line_range": [
                    3,
                    30
                ],
                "resource": "azurerm_key_vault.akv",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesFirewallRulesSettings",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/ensure-that-key-vault-allows-firewall-rules-settings",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_110",
                "bc_check_id": "BC_AZR_GENERAL_40",
                "check_name": "Ensure that key vault enables purge protection",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "purge_protection_enabled"
                    ]
                },
                "code_block": [
                    [
                        3,
                        "resource \"azurerm_key_vault\" \"akv\" {\n"
                    ],
                    [
                        4,
                        "  name                       = \"akv-n8n-tf-secrets\"\n"
                    ],
                    [
                        5,
                        "  location                   = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  resource_group_name        = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        7,
                        "  tenant_id                  = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        8,
                        "  sku_name                   = \"standard\"\n"
                    ],
                    [
                        9,
                        "  soft_delete_retention_days = 7\n"
                    ],
                    [
                        10,
                        "\n"
                    ],
                    [
                        11,
                        "  access_policy {\n"
                    ],
                    [
                        12,
                        "    tenant_id = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        13,
                        "    object_id = data.azurerm_client_config.current.object_id\n"
                    ],
                    [
                        14,
                        "\n"
                    ],
                    [
                        15,
                        "    secret_permissions = [\n"
                    ],
                    [
                        16,
                        "      \"Get\",\n"
                    ],
                    [
                        17,
                        "      \"List\",\n"
                    ],
                    [
                        18,
                        "      \"Set\",\n"
                    ],
                    [
                        19,
                        "      \"Delete\"\n"
                    ],
                    [
                        20,
                        "]\n"
                    ],
                    [
                        21,
                        "  }\n"
                    ],
                    [
                        22,
                        "  lifecycle {\n"
                    ],
                    [
                        23,
                        "    # \ud83d\udca5 SOLUTION : Ignorer tous les changements APRES la cr\u00e9ation\n"
                    ],
                    [
                        24,
                        "    # Si d'autres politiques sont ajout\u00e9es manuellement ou par d'autres scripts,\n"
                    ],
                    [
                        25,
                        "    # Terraform ignorera les changements sur la liste compl\u00e8te des politiques.\n"
                    ],
                    [
                        26,
                        "    ignore_changes = [\n"
                    ],
                    [
                        27,
                        "      access_policy\n"
                    ],
                    [
                        28,
                        "    ]\n"
                    ],
                    [
                        29,
                        "  }\n"
                    ],
                    [
                        30,
                        "}\n"
                    ]
                ],
                "file_path": "/keyvault.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "repo_file_path": "/terraform/keyvault.tf",
                "file_line_range": [
                    3,
                    30
                ],
                "resource": "azurerm_key_vault.akv",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.KeyVaultEnablesPurgeProtection",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-enables-purge-protection",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_189",
                "bc_check_id": "BC_AZR_NETWORKING_71",
                "check_name": "Ensure that Azure Key Vault disables public network access",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "public_network_access_enabled"
                    ]
                },
                "code_block": [
                    [
                        3,
                        "resource \"azurerm_key_vault\" \"akv\" {\n"
                    ],
                    [
                        4,
                        "  name                       = \"akv-n8n-tf-secrets\"\n"
                    ],
                    [
                        5,
                        "  location                   = data.azurerm_resource_group.rg.location\n"
                    ],
                    [
                        6,
                        "  resource_group_name        = data.azurerm_resource_group.rg.name\n"
                    ],
                    [
                        7,
                        "  tenant_id                  = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        8,
                        "  sku_name                   = \"standard\"\n"
                    ],
                    [
                        9,
                        "  soft_delete_retention_days = 7\n"
                    ],
                    [
                        10,
                        "\n"
                    ],
                    [
                        11,
                        "  access_policy {\n"
                    ],
                    [
                        12,
                        "    tenant_id = data.azurerm_client_config.current.tenant_id\n"
                    ],
                    [
                        13,
                        "    object_id = data.azurerm_client_config.current.object_id\n"
                    ],
                    [
                        14,
                        "\n"
                    ],
                    [
                        15,
                        "    secret_permissions = [\n"
                    ],
                    [
                        16,
                        "      \"Get\",\n"
                    ],
                    [
                        17,
                        "      \"List\",\n"
                    ],
                    [
                        18,
                        "      \"Set\",\n"
                    ],
                    [
                        19,
                        "      \"Delete\"\n"
                    ],
                    [
                        20,
                        "]\n"
                    ],
                    [
                        21,
                        "  }\n"
                    ],
                    [
                        22,
                        "  lifecycle {\n"
                    ],
                    [
                        23,
                        "    # \ud83d\udca5 SOLUTION : Ignorer tous les changements APRES la cr\u00e9ation\n"
                    ],
                    [
                        24,
                        "    # Si d'autres politiques sont ajout\u00e9es manuellement ou par d'autres scripts,\n"
                    ],
                    [
                        25,
                        "    # Terraform ignorera les changements sur la liste compl\u00e8te des politiques.\n"
                    ],
                    [
                        26,
                        "    ignore_changes = [\n"
                    ],
                    [
                        27,
                        "      access_policy\n"
                    ],
                    [
                        28,
                        "    ]\n"
                    ],
                    [
                        29,
                        "  }\n"
                    ],
                    [
                        30,
                        "}\n"
                    ]
                ],
                "file_path": "/keyvault.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "repo_file_path": "/terraform/keyvault.tf",
                "file_line_range": [
                    3,
                    30
                ],
                "resource": "azurerm_key_vault.akv",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.KeyVaultDisablesPublicNetworkAccess",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-networking-policies/azr-networking-189",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "breadcrumbs": {
                    "resource_group_name": [
                        {
                            "type": "data",
                            "name": "azurerm_resource_group.rg",
                            "path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/data.tf",
                            "module_connection": false
                        }
                    ]
                }
            },
            {
                "check_id": "CKV_AZURE_41",
                "bc_check_id": "BC_AZR_SECRETS_1",
                "check_name": "Ensure that the expiration date is set on all secrets",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "expiration_date"
                    ]
                },
                "code_block": [
                    [
                        32,
                        "resource \"azurerm_key_vault_secret\" \"pg_password\" {\n"
                    ],
                    [
                        33,
                        "  name         = \"pg-admin-password\"\n"
                    ],
                    [
                        34,
                        "  key_vault_id = azurerm_key_vault.akv.id\n"
                    ],
                    [
                        35,
                        "  value        = var.pg_admin_password\n"
                    ],
                    [
                        36,
                        "}"
                    ]
                ],
                "file_path": "/keyvault.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "repo_file_path": "/terraform/keyvault.tf",
                "file_line_range": [
                    32,
                    36
                ],
                "resource": "azurerm_key_vault_secret.pg_password",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.SecretExpirationDate",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-secrets-policies/set-an-expiration-date-on-all-secrets",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf"
            },
            {
                "check_id": "CKV_AZURE_114",
                "bc_check_id": "BC_AZR_GENERAL_42",
                "check_name": "Ensure that key vault secrets have \"content_type\" set",
                "check_result": {
                    "result": "FAILED",
                    "evaluated_keys": [
                        "content_type"
                    ]
                },
                "code_block": [
                    [
                        32,
                        "resource \"azurerm_key_vault_secret\" \"pg_password\" {\n"
                    ],
                    [
                        33,
                        "  name         = \"pg-admin-password\"\n"
                    ],
                    [
                        34,
                        "  key_vault_id = azurerm_key_vault.akv.id\n"
                    ],
                    [
                        35,
                        "  value        = var.pg_admin_password\n"
                    ],
                    [
                        36,
                        "}"
                    ]
                ],
                "file_path": "/keyvault.tf",
                "file_abs_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf",
                "repo_file_path": "/terraform/keyvault.tf",
                "file_line_range": [
                    32,
                    36
                ],
                "resource": "azurerm_key_vault_secret.pg_password",
                "evaluations": null,
                "check_class": "checkov.terraform.checks.resource.azure.SecretContentType",
                "fixed_definition": null,
                "entity_tags": null,
                "caller_file_path": null,
                "caller_file_line_range": null,
                "resource_address": null,
                "severity": null,
                "bc_category": null,
                "benchmarks": null,
                "description": null,
                "short_description": null,
                "vulnerability_details": null,
                "connected_node": null,
                "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/azure-policies/azure-general-policies/ensure-that-key-vault-secrets-have-content-type-set",
                "details": [],
                "check_len": null,
                "definition_context_file_path": "/home/gyme/INFRA-CLOUD-TP/TP-6/terraform/keyvault.tf"
            }
        ]
    },
    "summary": {
        "passed": 11,
        "failed": 33,
        "skipped": 0,
        "parsing_errors": 0,
        "resource_count": 20,
        "checkov_version": "3.2.470"
    }
}
